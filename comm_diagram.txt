@startuml
  participant robot
  participant sensor
  participant UI

  box trajcontrol
    participant estimator
    participant controller
  end box

  group time sync
    robot -> estimator: stage/state/needle_pose [PoseStamped]
    sensor -> estimator: /needle/state/shape [PoseArray]
  end

  UI -> estimator: /subject/state/skin_entry [PoseStamped]
  estimator -> controller: /needle/state/jacobian [Image] (Matrix)
  UI -> controller: /subject/state/target [PoseStamped]
  controller -> robot: /move_stage [MoveStage]
@enduml
